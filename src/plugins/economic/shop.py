import lightbulb
import hikari
import miru

from config import setting
from utils import local, access, db

plugin = lightbulb.Plugin("shop", default_enabled_guilds=setting.guild_id)


@plugin.command()
@lightbulb.add_checks(access.disable_command)
@lightbulb.option(
    name="list",
    description="–í—ã–±–µ—Ä–∏—Ç–µ –∏–∑ —Å–ø–∏—Å–∫–∞, —á—Ç–æ –≤—ã —Ö–æ—Ç–∏—Ç–µ –∫—É–ø–∏—Ç—å",
    type = hikari.OptionType.STRING,
    choices=[
        "–£–¥–æ—á–∫–∞",
        "–ö—Ä—é—á–æ–∫",
        "–ë–∞–Ω–Ω–µ—Ä"
    ],
    required=False
)
@lightbulb.option(
    name="id",
    description="ID –ø–æ–∫—É–ø–∫–∏",
    type= hikari.OptionType.INTEGER,
    required=False
)
@lightbulb.command("shop", "–ì–ª–æ–±–∞–ª—å–Ω—ã–π –º–∞–≥–∞–∑–∏–Ω –±–æ—Ç–∞")
@lightbulb.implements(lightbulb.SlashCommand)
async def shop(ctx: lightbulb.Context) -> None:
    l = local.localization(ctx.get_guild().id)
    user = db.user(ctx.author.id)
    list = ctx.options.list

    class ShopButton(miru.View):

        @miru.button(emoji="üé£", style=hikari.ButtonStyle.SECONDARY)
        async def rod_list(self, button: miru.Button, ctx: miru.ViewContext) -> None:
            emb = (
                hikari.Embed(
                    title="–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É–¥–æ—á–µ–∫",
                    description="ID:1 **–ü–∞–ª–æ—á–∫–∞ —Å –≤–µ—Ä–µ–≤–∫–æ–π** 100 :coin:",
                    color=setting.color
                )
            )
            await ctx.respond(
                embed=emb,
                component=None,
                flags=hikari.MessageFlag.EPHEMERAL
            )

        @miru.button(emoji="ü™ù", style=hikari.ButtonStyle.SECONDARY)
        async def fish_hook_list(self, button: miru.Button, ctx: miru.ViewContext) -> None:
            emb = (
                hikari.Embed(
                    title="–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –∫—Ä—é—á–∫–æ–≤",
                    description="ID:1 **–ß–µ—Ä–≤—è–∫** 250:coin:",
                    color=setting.color
                )
            )
            await ctx.respond(
                embed=emb,
                component=None,
                flags=hikari.MessageFlag.EPHEMERAL
            )

        @miru.button(emoji="üñºÔ∏è", style=hikari.ButtonStyle.SECONDARY)
        async def banner_list(self, button: miru.Button, ctx: miru.ViewContext):
            emb = (
                hikari.Embed(
                    title="–°–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö –±–∞–Ω–Ω–µ—Ä–æ–≤",
                    description="–í–µ—Å—å —Å–ø–∏—Å–æ–∫ –±–∞–Ω–Ω–µ—Ä–æ–≤ –Ω–∞—Ö–æ–¥–∏—Ç—å—Å—è [–∑–¥–µ—Å—å](https://boticord.gay)",
                    color=setting.color
                )
            )
            await ctx.respond(
                embed=emb,
                component=None,
                flags=hikari.MessageFlag.EPHEMERAL
            )


    emb = (
        hikari.Embed(
            title="–ú–∞–≥–∞–∑–∏–Ω –±–æ—Ç–∞",
            description="–ó–¥–µ—Å—å –≤—ã –º–æ–∂–µ—Ç–µ –ø–æ–∫—É–ø–∞—Ç—å –∫–∞–∫ —É–¥–æ—á–∫–∏ –∏ –∫—Ä—é—á–∫–∏, —Ç–∞–∫ –∏ –±–∞–Ω–Ω–µ—Ä—ã –¥–ª—è —Å–≤–æ–µ–≥–æ –ø—Ä–æ—Ñ–∏–ª—è\n–î–ª—è –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–µ–π –ø–æ—Å–µ—Ç–∏—Ç–µ [–¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é](https://docs.maibot.xyz)",
            color=setting.color
        )
    )

    if list or ctx.options.id == None:
        button = ShopButton()
        msg = await ctx.respond(embed=emb, components=button, flags=hikari.MessageFlag.EPHEMERAL)
        await button.start(msg)
        return

    if list == "–£–¥–æ—á–∫–∞":
        id = int(ctx.options.id)

        if user["rod"] >= id:
            await ctx.respond("–£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å —Ç–∞–∫–∞—è —É–¥–æ—á–∫–∞ –∏–ª–∏ –±—ã–ª–∞ –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏")
            return

        if id <= 0:
            await ctx.respond(123)
            return

        if id == 1:
            if user["coin"] < 900:
                await ctx.respond("–£ –≤–∞—Å –Ω–µ—Ç –¥–µ–Ω–µ–≥ –Ω–∞ –ø–æ–∫—É–ø–∫—É F")
                return

            db.db.user.update_one(
                {"id": ctx.author.id},
                {"$set": {
                    "rod": id
                }}
            )

            await ctx.respond("–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–∫—É–ø–∫—É")
        if id == 2:
            if user["coin"] <= 2000:
                await ctx.respond("–£ –≤–∞—Å –Ω–µ—Ç –¥–µ–Ω–µ–≥ –Ω–∞ –ø–æ–∫—É–ø–∫—É F")
                return

            db.db.user.update_one(
                {"id": ctx.author.id},
                {"$set": {
                    "rod": id
                }}
            )

            await ctx.respond("–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–∫—É–ø–∫—É")
        if id == 3:
            if user["coin"] <= 4500:
                await ctx.respond("–£ –≤–∞—Å –Ω–µ—Ç –¥–µ–Ω–µ–≥ –Ω–∞ –ø–æ–∫—É–ø–∫—É F")
                return

            db.db.user.update_one(
                {"id": ctx.author.id},
                {"$set": {
                    "rod": id
                }}
            )

            await ctx.respond("–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–∫—É–ø–∫—É")
        if id == 4:
            if user["coin"] <= 7800:
                await ctx.respond("–£ –≤–∞—Å –Ω–µ—Ç –¥–µ–Ω–µ–≥ –Ω–∞ –ø–æ–∫—É–ø–∫—É F")
                return

            db.db.user.update_one(
                {"id": ctx.author.id},
                {"$set": {
                    "rod": id
                }}
            )

            await ctx.respond("–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–∫—É–ø–∫—É")
        if id == 5:
            if user["coin"] <= 11000:
                await ctx.respond("–£ –≤–∞—Å –Ω–µ—Ç –¥–µ–Ω–µ–≥ –Ω–∞ –ø–æ–∫—É–ø–∫—É F")
                return

            db.db.user.update_one(
                {"id": ctx.author.id},
                {"$set": {
                    "rod": id
                }}
            )

            await ctx.respond("–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–∫—É–ø–∫—É")
        if id == 6:
            if user["coin"] <= 16500:
                await ctx.respond("–£ –≤–∞—Å –Ω–µ—Ç –¥–µ–Ω–µ–≥ –Ω–∞ –ø–æ–∫—É–ø–∫—É F")
                return

            db.db.user.update_one(
                {"id": ctx.author.id},
                {"$set": {
                    "rod": id
                }}
            )

            await ctx.respond("–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–∫—É–ø–∫—É")
        if id == 7:
            if user["coin"] <= 20000:
                await ctx.respond("–£ –≤–∞—Å –Ω–µ—Ç –¥–µ–Ω–µ–≥ –Ω–∞ –ø–æ–∫—É–ø–∫—É F")
                return

            db.db.user.update_one(
                {"id": ctx.author.id},
                {"$set": {
                    "rod": id
                }}
            )

            await ctx.respond("–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–∫—É–ø–∫—É")
        if id == 8:
            if user["coin"] <= 27000:
                await ctx.respond("–£ –≤–∞—Å –Ω–µ—Ç –¥–µ–Ω–µ–≥ –Ω–∞ –ø–æ–∫—É–ø–∫—É F")
                return

            db.db.user.update_one(
                {"id": ctx.author.id},
                {"$set": {
                    "rod": id
                }}
            )

            await ctx.respond("–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–∫—É–ø–∫—É")
        if id == 9:
            if user["coin"] <= 40000:
                await ctx.respond("–£ –≤–∞—Å –Ω–µ—Ç –¥–µ–Ω–µ–≥ –Ω–∞ –ø–æ–∫—É–ø–∫—É F")
                return

            db.db.user.update_one(
                {"id": ctx.author.id},
                {"$set": {
                    "rod": id
                }}
            )

            await ctx.respond("–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–∫—É–ø–∫—É")
        else:
            await ctx.respond("—Ç–∞–∫–æ–π —É–¥–æ—á–∫–∏ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç")

    if list == "–ö—Ä—é—á–æ–∫":
        id = int(ctx.options.id)

        if user["fish_hook"] >= id:
            await ctx.respond("–£ –≤–∞—Å —É–∂–µ –µ—Å—Ç—å —Ç–∞–∫–æ–π –∫—Ä—é—á–æ–∫ –∏–ª–∏ –±—ã–ª –≤ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏")
            return

        if id <= 0:
            await ctx.respond(123)
            return

        if id == 1:
            if user["coin"] <= 250:
                await ctx.respond("–£ –≤–∞—Å –Ω–µ—Ç –¥–µ–Ω–µ–≥ –Ω–∞ –ø–æ–∫—É–ø–∫—É F")
                return

            db.db.user.update_one(
                {"id": ctx.author.id},
                {"$set": {
                    "fish_hook": id
                }}
            )

            await ctx.respond("–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–∫—É–ø–∫—É")
        if id == 2:
            if user["coin"] <= 500:
                await ctx.respond("–£ –≤–∞—Å –Ω–µ—Ç –¥–µ–Ω–µ–≥ –Ω–∞ –ø–æ–∫—É–ø–∫—É F")
                return

            db.db.user.update_one(
                {"id": ctx.author.id},
                {"$set": {
                    "fish_hook": id
                }}
            )

            await ctx.respond("–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–∫—É–ø–∫—É")
        if id == 3:
            if user["coin"] <= 1250:
                await ctx.respond("–£ –≤–∞—Å –Ω–µ—Ç –¥–µ–Ω–µ–≥ –Ω–∞ –ø–æ–∫—É–ø–∫—É F")
                return

            db.db.user.update_one(
                {"id": ctx.author.id},
                {"$set": {
                    "fish_hook": id
                }}
            )

            await ctx.respond("–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–∫—É–ø–∫—É")
        if id == 4:
            if user["coin"] <= 2500:
                await ctx.respond("–£ –≤–∞—Å –Ω–µ—Ç –¥–µ–Ω–µ–≥ –Ω–∞ –ø–æ–∫—É–ø–∫—É F")
                return

            db.db.user.update_one(
                {"id": ctx.author.id},
                {"$set": {
                    "fish_hook": id
                }}
            )

            await ctx.respond("–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–∫—É–ø–∫—É")
        if id == 5:
            if user["coin"] <= 3600:
                await ctx.respond("–£ –≤–∞—Å –Ω–µ—Ç –¥–µ–Ω–µ–≥ –Ω–∞ –ø–æ–∫—É–ø–∫—É F")
                return

            db.db.user.update_one(
                {"id": ctx.author.id},
                {"$set": {
                    "fish_hook": id
                }}
            )

            await ctx.respond("–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–∫—É–ø–∫—É")
        if id == 6:
            if user["macoin"] <= 25:
                await ctx.respond("–£ –≤–∞—Å –Ω–µ—Ç –¥–µ–Ω–µ–≥ –Ω–∞ –ø–æ–∫—É–ø–∫—É F")
                return

            db.db.user.update_one(
                {"id": ctx.author.id},
                {"$set": {
                    "fish_hook": id
                }}
            )

            await ctx.respond("–ë–ª–∞–≥–æ–¥–∞—Ä–∏–º –∑–∞ –ø–æ–∫—É–ø–∫—É")
        else:
            await ctx.respond("—Ç–∞–∫–æ–≥–æ –∫—Ä—é—á–∫–∞ –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç")

def load(client):
    client.add_plugin(plugin)